<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ó–∞–∫–∞–∑ —Ä–∞–±–æ—Ç—ã @awarem</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #ffffff; --sec-bg: #f4f4f5; --text: #000000; --hint: #707579;
            --card-border: rgba(0,0,0,0.1); --accent: #3390ec; --accent-red: #ff3b30; --accent-green: #34c759;
            --toggle-off: #dee2e6;
        }
        [data-theme="dark"] {
            --bg: #1c1c1d; --sec-bg: #2c2c2e; --text: #ffffff; --hint: #8e8e93; 
            --card-border: rgba(255,255,255,0.1); --toggle-off: #3a3a3c;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg); color: var(--text); margin: 0; padding: 16px;
            display: flex; flex-direction: column; gap: 12px; transition: 0.3s;
        }

        .theme-toggle {
            position: absolute; top: 12px; right: 16px; background: var(--sec-bg);
            border: 1px solid var(--card-border); border-radius: 50%; width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 1000;
        }

        .card { background: var(--sec-bg); border-radius: 16px; padding: 14px; border: 1px solid var(--card-border); position: relative; }
        label { font-size: 10px; color: var(--hint); font-weight: 800; text-transform: uppercase; margin-bottom: 6px; display: block; }
        
        .input-wrapper { position: relative; width: 100%; display: flex; align-items: center; }
        input, select, textarea {
            background: var(--bg); border: 1px solid var(--card-border); border-radius: 10px;
            color: var(--text); font-size: 16px; padding: 10px; width: 100%; box-sizing: border-box; outline: none;
        }
        .with-tip { padding-right: 35px !important; }

        .inner-tip {
            position: absolute; right: 8px; color: var(--accent); font-weight: 700;
            background: var(--sec-bg); width: 22px; height: 22px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 12px;
            cursor: pointer; border: 1px solid var(--card-border); z-index: 5;
        }

        .row { display: flex; gap: 10px; align-items: flex-end; width: 100%; }
        .flex-1 { flex: 1; min-width: 0; }

        .status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent-green); }
        .dot-online { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(0.9); opacity: 1; } 70% { transform: scale(1.2); opacity: 0.5; } 100% { transform: scale(0.9); opacity: 1; } }

        .main-btn { background: var(--accent); color: white; border: none; padding: 16px; border-radius: 14px; font-size: 16px; font-weight: 700; width: 100%; cursor: pointer; margin-top: 4px; }
        .secondary-btn { background: var(--sec-bg); border: 1px solid var(--card-border); color: var(--accent); padding: 10px; border-radius: 12px; font-size: 13px; font-weight: 600; text-align: center; flex: 1; cursor: pointer; }
        
        .preview-box { background: var(--sec-bg); border: 1px dashed var(--hint); border-radius: 12px; padding: 12px; font-family: monospace; font-size: 12px; white-space: pre-line; max-height: 0; opacity: 0; overflow: hidden; transition: 0.4s; }
        .preview-box.show { max-height: 500px; opacity: 1; margin: 10px 0; border: 1px solid var(--accent); }

        .advantage-item { text-align: center; flex: 1; }
        .advantage-icon { font-size: 20px; }
        .advantage-text { font-size: 9px; font-weight: 700; color: var(--hint); text-transform: uppercase; }

        .feedback-callout {
            background: linear-gradient(135deg, rgba(51, 144, 236, 0.08), rgba(52, 199, 89, 0.08));
            border: 1px solid var(--card-border); border-radius: 12px; padding: 10px;
            text-align: center; font-size: 11px; color: var(--text); line-height: 1.3;
        }

        .disclaimer { font-size: 10px; color: var(--hint); text-align: center; margin-top: 4px; line-height: 1.4; }

        .switch { position: relative; display: inline-block; width: 40px; height: 22px; flex-shrink: 0; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--toggle-off); transition: .3s; border-radius: 22px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .3s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent-green); }
        input:checked + .slider:before { transform: translateX(18px); }
    </style>
</head>
<body>

<div class="theme-toggle" onclick="toggleTheme()" id="theme-btn">‚òÄÔ∏è</div>

<div class="row">
    <div class="secondary-btn" onclick="tg.openTelegramLink('https://t.me/txtandpptx')">üì¢ –ö–∞–Ω–∞–ª</div>
    <div class="secondary-btn" onclick="tg.openTelegramLink('https://t.me/OTZblBblawarem')">‚≠ê –û—Ç–∑—ã–≤—ã</div>
</div>

<div class="card" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 14px;">
    <div style="display: flex; align-items: center; gap: 8px;">
        <div id="status-dot" class="status-dot dot-online"></div>
        <span id="status-text" style="font-size: 12px; font-weight: 800; text-transform: uppercase; color: var(--accent-green);">–°—Ç–∞—Ç—É—Å: –°–≤–æ–±–æ–¥–µ–Ω</span>
    </div>
    <span id="response-time" style="font-size: 11px; color: var(--hint);">–û—Ç–≤–µ—Ç: 5-10 –º–∏–Ω</span>
</div>

<div style="display: flex; justify-content: space-around; gap: 8px;">
    <div class="advantage-item"><div class="advantage-icon">‚ö°Ô∏è</div><div class="advantage-text">–ë—ã—Å—Ç—Ä–æ</div></div>
    <div class="advantage-item"><div class="advantage-icon">üíé</div><div class="advantage-text">–ö–∞—á–µ—Å—Ç–≤–æ</div></div>
    <div class="advantage-item"><div class="advantage-icon">üîí</div><div class="advantage-text">–ê–Ω–æ–Ω–∏–º–Ω–æ</div></div>
</div>

<div class="card">
    <label>–í–∏–¥ —Ä–∞–±–æ—Ç—ã</label>
    <select id="type" onchange="update()">
        <option value="–†–µ—Ñ–µ—Ä–∞—Ç">üìù –†–µ—Ñ–µ—Ä–∞—Ç</option>
        <option value="–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è">üìä –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è</option>
        <option value="–î–æ–∫–ª–∞–¥">üé§ –î–æ–∫–ª–∞–¥</option>
        <option value="–ü—Ä–æ–µ–∫—Ç">üí° –ü—Ä–æ–µ–∫—Ç</option>
        <option value="–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–µ–∫—Ü–∏—é">üñã –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–µ–∫—Ü–∏—é</option>
    </select>
    
    <div class="row" style="margin-top:12px">
        <div class="flex-1">
            <label id="unit-label">–ö–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü</label>
            <input type="number" id="count" placeholder="0" oninput="update()">
        </div>
        <div class="flex-1">
            <label>–î–µ–¥–ª–∞–π–Ω</label>
            <div class="input-wrapper">
                <input type="text" id="date" maxlength="5" class="with-tip" oninput="update()">
                <div class="inner-tip" onclick="showTip('deadline')">?</div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <label>–î–µ—Ç–∞–ª–∏ –∏ –±—é–¥–∂–µ—Ç</label>
    <div class="input-wrapper">
        <textarea id="details" rows="2" class="with-tip" placeholder="–¢–µ–º–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ..." oninput="update()"></textarea>
        <div class="inner-tip" style="top: 10px;" onclick="showTip('details')">?</div>
    </div>
    <div style="margin-top:12px">
        <label>–°—É–º–º–∞ (‚ÇΩ)</label>
        <input type="number" id="price" placeholder="500" oninput="update()">
    </div>
</div>

<div class="card" style="padding: 12px 14px; display: flex; justify-content: space-between; align-items: center;">
    <span style="font-size: 14px; font-weight: 700;">üö® –°—Ä–æ—á–Ω—ã–π –∑–∞–∫–∞–∑</span>
    <label class="switch"><input type="checkbox" id="urgent" onchange="update()"><span class="slider"></span></label>
</div>

<div class="preview-box" id="preview"></div>
<button class="main-btn" onclick="copy()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∫–µ—Ç—É</button>

<div class="row" style="align-items: stretch;">
    <button class="secondary-btn" style="color:var(--accent-red); flex: 0.3;" onclick="clearAll()">üóë</button>
    <div class="feedback-callout" style="flex: 1; display: flex; align-items: center; justify-content: center;">
        ‚ú® –ë—É–¥—É —Ä–∞–¥ –æ—Ç–∑—ã–≤—É –≤ <b>–õ–∏—á–Ω—ã–µ –°–æ–æ–±—â–µ–Ω–∏—è</b>!
    </div>
</div>

<div class="disclaimer">
    üí≥ <b>–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 100%</b> | ‚úÖ –ë–µ–∑ –∞–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç–∞<br>
    –†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ –≤–∞—à–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º.
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞—Ç—ã +7 –¥–Ω–µ–π
    function getAutoDate() {
        const d = new Date();
        d.setDate(d.getDate() + 7);
        return String(d.getDate()).padStart(2, '0') + '.' + String(d.getMonth() + 1).padStart(2, '0');
    }

    // –°—Ç–∞–≤–∏–º –¥–∞—Ç—É –≤ placeholder
    document.getElementById('date').placeholder = getAutoDate();

    function showTip(f) {
        const tips = {
            deadline: "–£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É (–î–î.–ú–ú). –ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º ‚Äî –¥–µ–¥–ª–∞–π–Ω –±—É–¥–µ—Ç —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é.",
            details: "–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–º—É –∏ –≤–∞–∂–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è."
        };
        tg.showAlert(tips[f]);
    }

    function checkNight() {
        try {
            const options = { timeZone: 'Asia/Yakutsk', hour: 'numeric', hour12: false };
            const h = parseInt(new Intl.DateTimeFormat('ru-RU', options).format(new Date()));
            const isNight = h >= 23 || h < 7;
            const stText = document.getElementById('status-text');
            const stDot = document.getElementById('status-dot');
            const respTime = document.getElementById('response-time');

            if (isNight) {
                stText.innerText = "–°—Ç–∞—Ç—É—Å: –°–ø–ª—é";
                stText.style.color = "var(--hint)";
                stDot.className = "status-dot";
                respTime.innerText = "–û—Ç–≤–µ—á—É —É—Ç—Ä–æ–º (–ú–°–ö+6)";
            } else {
                stText.innerText = "–°—Ç–∞—Ç—É—Å: –°–≤–æ–±–æ–¥–µ–Ω";
                stText.style.color = "var(--accent-green)";
                stDot.className = "status-dot dot-online";
                respTime.innerText = "–û—Ç–≤–µ—Ç: 5-10 –º–∏–Ω";
            }
        } catch (e) { console.log(e); }
    }

    function toggleTheme() {
        const current = document.body.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        document.body.setAttribute('data-theme', next);
        document.getElementById('theme-btn').innerText = next === 'dark' ? 'üåô' : '‚òÄÔ∏è';
        tg.HapticFeedback.impactOccurred('light');
    }

    function update() {
        const type = document.getElementById('type').value,
              count = document.getElementById('count').value, 
              dateInput = document.getElementById('date').value,
              // –ï—Å–ª–∏ –≤ –ø–æ–ª–µ –ø—É—Å—Ç–æ, –±–µ—Ä–µ–º –¥–∞—Ç—É —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é
              finalDate = dateInput || getAutoDate(),
              price = document.getElementById('price').value, 
              det = document.getElementById('details').value || '–Ω–µ —É–∫–∞–∑–∞–Ω—ã',
              urg = document.getElementById('urgent').checked;

        document.getElementById('unit-label').innerText = type.includes("–ü—Ä–µ–∑") ? "–ö–æ–ª-–≤–æ —Å–ª–∞–π–¥–æ–≤" : "–ö–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü";
        
        const canShow = count && price;
        const preview = document.getElementById('preview');
        preview.classList.toggle('show', !!canShow);

        let header = urg ? 'üö® –°–†–û–ß–ù–´–ô –ó–ê–ö–ê–ó üö®\n' : '';
        preview.innerText = `${header}1. –í–∏–¥: ${type}\n2. –ö–æ–ª-–≤–æ: ${count}\n3. –î–µ–¥–ª–∞–π–Ω: ${finalDate}\n4. –°—É–º–º–∞: ${price} —Ä—É–±.\n5. –î–µ—Ç–∞–ª–∏: ${det}\n---\n‚úÖ –°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ 100% –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É.`;
    }

    function copy() {
        const c = document.getElementById('count'), p = document.getElementById('price');
        if (!c.value || !p.value) { 
            tg.showAlert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Å—É–º–º—É!"); 
            return; 
        }
        
        const area = document.createElement("textarea");
        area.value = document.getElementById('preview').innerText;
        document.body.appendChild(area); area.select();
        document.execCommand('copy'); document.body.removeChild(area);
        
        tg.HapticFeedback.notificationOccurred('success');
        tg.showConfirm("–ê–Ω–∫–µ—Ç–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –û—Ç–ø—Ä–∞–≤–∏—Ç—å –µ—ë @awarem?", (ok) => {
            if (ok) tg.openTelegramLink("https://t.me/awarem");
        });
    }

    function clearAll() {
        if(confirm("–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ–ª—è?")) {
            document.querySelectorAll('input, textarea').forEach(el => el.value = '');
            document.getElementById('urgent').checked = false;
            update();
        }
    }

    if (tg.colorScheme === 'dark') {
        document.body.setAttribute('data-theme', 'dark');
        document.getElementById('theme-btn').innerText = 'üåô';
    }

    checkNight();
    update();
</script>
</body>
</html>
